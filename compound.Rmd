---
title: "R Notebook"
output: html_notebook
---


```{r}
install.packages("hypergeo")
install.packages("Compounding")
```

```{r}

library(Compounding)
```

```{r}
dCompound <-
function(x,parent,compound,compoundDist,params,...) {
    if (!exists(paste("p",parent,sep=""))) {
        return(paste("The parent distribution",parent,"doesn't exist"))
    }
    if (!is.element(compound,compoundDist)) {
        return(paste("The discrete distribution",compound,"doesn't exist"))
    }
    xval <- double(length(x))
    f <- get(paste("d", parent, sep = ""), mode = "function")
    F <- get(paste("p", parent, sep = ""), mode = "function")
    phi <- get(paste("pgf",compound,sep=""), mode = "function")
    phiD <- get(paste("pgfD",compound,sep=""), mode = "function")
    xval <- phiD(1-F(x,...),params)*f(x,...)/(1-phi(0,params))
    return(xval)
}
```

```{r}
compoundDist <- c("geometric","poisson","negativebinomial","binomial",
"logarithmic","binomialbinomial","binomialpoisson",
"poissonbinomial","neymantypea","polyaaeppli",
"poissonpascal","pascalpoisson",
"logarithmicbinomial","logarithmicpoisson",
"poissonlindley",
"hyperpoisson","yule","waring","kattitypeh1",
"kattitypeh2","neymantypeb","neymantypec",
"hypergeometric","thomas")
parentD<-"beta"
compoundD<-"poisson"
params<-c(6000)
x<-seq(from=0, to=0.00002, length.out=400)
curve(dCompound(x,parentD,compoundD,compoundDist,params,shape1=1,shape2=6000),xlim=c(0,0.00002),ylim=c(0,6000))
print(dCompound(x,parentD,compoundD,compoundDist,params,shape1=1,shape2=6000))

```

```{r}
x<-seq(from=0, to=0.0003, length.out=80)
n=409995
l=409995
curve(n*(1-x)**(n-1)*l*exp(-l+l*(1-x)**n), xlim=c(0,0.0003))
```


```{r}
parentD<-"beta"
compoundD<-"binomial"
params<-c(1500000, 409995./1500000)
x<-seq(from=0, to=0.0003, length.out=80)
curve(dCompound(x,parentD,compoundD,compoundDist,params,shape1=1,shape2=0.1),xlim=c(0,0.0003),ylim=c(0,40995.))
print(momentCompound(1,parentD,compoundD,compoundDist,params,shape1=1,shape2=1))

```

```{r}
install.packages("rmutil")
library(rmutil)
```


```{r}
x<-seq(from=0, to=0.0003, length.out=80)
b=65000
curve((b*exp(b*log(1-x))/log(1-x)-(1/(log(1-x))**2)*(exp(b*log(1-x))-1))/(1-x),xlim=c(0,0.0003))
```
```{r}
?pbeta
n=6000
 curve(pbeta(x, 1, 6000), from = 0, to = 1)
 curve((1-(1-x)**n), from = 0, to = 1)
```


```{r}
x<-seq(from=0, to=0.0003, length.out=80)
b=409995
n=1500000
p=b/n
curve(b*((1-x)**(b-1))*n*p*(1-p+p*(1-x)**b)**(n-1), xlim=c(0,0.0003))
```

```{r}

x<-seq(from=0, to=0.0003, length.out=80)
n=409995
l=409995

curve(n*(1-x)**(n-1)*l*exp(-l+l*(1-x)**n), xlim=c(0,0.0003))
```
```

